pipeline:
  inputs:
    username:
      type: string
      default: ubuntu
    password:
      type: string

  clone:
    depth: 50

  env:
    GOOS: linux

  environment:
    items:
    - name: prod

  stages:
  - steps:
    - run:
        script: go build
    - run:
        script: go build
    - run:
        script: go build
        container:
          image: golang
    - run:
        script:
        - go build
        - go test
        container:
          image: golang
          pull: if-not-exists
